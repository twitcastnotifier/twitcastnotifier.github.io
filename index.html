<!doctype html>

<html lang="ja">
<head>
  <meta charset="utf-8">

  <title>ツイキャス通知</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="../css/styles.css?v=1.0">
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>

  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script> 
   <script src="../js/script.js"></script>
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">


  <!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

<body>


    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Twitcasting Notifier Beta</a>
        </div>
        
      </div>
    </nav>

	<div class="container">
	    <div class="row">
	        <form role="form" id="input-form"  method="POST" action="" target="no-target">
	            <div class="col-lg-6">
	                <div class="well well-sm"><strong><span class="glyphicon glyphicon-asterisk"></span>Required Field</strong></div>
	                <div class="form-group">
	                    <label for="InputName">自分のTwitter ID</label>
	                    <div class="input-group">
	                        <input type="text" class="form-control" name="InputName" id="listener" placeholder="@userid" required>
	                        <span class="input-group-addon"><span class="glyphicon glyphicon-asterisk"></span></span>
	                    </div>
	                </div>

	                <div class="form-group">
	                    <label for="InputName">通知したい主のID</label>
	                    <div class="input-group">
	                        <input type="text" class="form-control" name="InputName" id="caster" placeholder="casterid" required>
	                        <span class="input-group-addon"><span class="glyphicon glyphicon-asterisk"></span></span>
	                    </div>
	                </div>
	                
	                <input type="submit" name="submit" id="submit" value="Submit" class="btn btn-info pull-right">
	            </div>
	        </form>
	        
	    </div>
	</div>

	<iframe src="about:blank" id="no-target" name="no-target" style="visibility:hidden"></iframe>

	
    

    <div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
            <h4 class="modal-title" id="myModalLabel">登録完了</h4>
            </div>
            <div class="modal-body">
                <p>登録を完了するためには以下のツイッターアカウントをフォロー必要があります</p>
	               <a href="https://twitter.com/twitcastnotif" class="twitter-follow-button" data-show-count="false">Follow @twitcastnotif</a>
					<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                
        	</div>
    	</div>
  	</div>



	<script>

    $('#input-form').submit(function() {
    	var listenerInput = encodeURIComponent($('#listener').val());
        var casterInput = encodeURIComponent($('#caster').val());

        var baseURL = 'https://docs.google.com/forms/d/144W7sdh2PAQkp_kxVlRjcwpPk85Jj2kY2GrKPn1MXXM/formResponse?';
        var submitRef = '&submit=Submit';
        var submitURL = (baseURL + "entry.1182607633="+listenerInput+"&entry.1562116357=" +casterInput + submitRef);
        console.log(submitURL);
        $(this)[0].action=submitURL;
        document.getElementsByName('no-target')[0].src="#"
        
        $("input[type=text], textarea").val("");
	    return true;

	});

	$("#no-target").load( function() {
		if ( $(this)[0].src!="about:blank"){
			$('#basicModal').modal('show');
			$(this)[0].src="about:blank";
		}


	} );

	 
	 	


	
	</script>


</body>
</html>